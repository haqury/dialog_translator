name: Build and Release

on:
  push:
    tags:
      - 'v*'  # –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ —Ç–µ–≥–∏ —Ç–∏–ø–∞ v1.0.0

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install pyinstaller
    
    - name: Build EXE
      run: |
        python build_exe.py
    
    - name: Create ZIP archive
      run: |
        Compress-Archive -Path dist\TransGoogleTest\* -DestinationPath TransGoogleTest-${{ github.ref_name }}-win64.zip
      shell: powershell
    
    - name: Create Release
      uses: softprops/action-gh-release@v1
      with:
        files: TransGoogleTest-${{ github.ref_name }}-win64.zip
        body: |
          ## üéâ TransGoogleTest ${{ github.ref_name }}
          
          ### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
          
          1. –°–∫–∞—á–∞–π—Ç–µ `TransGoogleTest-${{ github.ref_name }}-win64.zip`
          2. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤
          3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `TransGoogleTest.exe`
          
          ### ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
          
          - üé§ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —á–µ—Ä–µ–∑ Google Web Speech API
          - üåê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ —á–µ—Ä–µ–∑ Google Translate
          - üîä –û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —á–µ—Ä–µ–∑ ElevenLabs TTS
          - üéØ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 5 —è–∑—ã–∫–æ–≤: RU, EN, ES, FR, DE
          
          ### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
          
          - Windows 7/8/10/11 (64-bit)
          - –ú–∏–∫—Ä–æ—Ñ–æ–Ω –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏
          - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
          
          ### üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞
          
          1. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å–æ–∑–¥–∞—Å—Ç—Å—è `config.json`
          2. –î–æ–±–∞–≤—å—Ç–µ API –∫–ª—é—á ElevenLabs –¥–ª—è –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
          3. –ì–æ—Ç–æ–≤–æ!
          
          ---
          
          **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [README.md](https://github.com/${{ github.repository }})
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
